<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" type="text/css"
	th:href="@{/webjars/bootstrap/3.3.7/css/bootstrap.min.css}" />

<!-- include java script in the footer -->
<script type="text/javascript"
	th:src="@{/webjars/jquery/3.2.1/jquery.min.js/}"></script>
<script type="text/javascript"
	th:src="@{/webjars/bootstrap/3.3.7/js/bootstrap.min.js}"></script>

<title>Spring Boot APP with MongoDB</title>

<style>
    body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        padding-bottom: 30px;
    }
    
    .blue-badge {
        background-color: #007bff;
        color: white;
        padding: 4px 10px;
        border-radius: 4px;
        display: inline-block;
        margin-bottom: 5px;
        font-size: 12px;
        font-weight: bold;
    }
    
    .container {
        background-color: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 5px 25px rgba(0,0,0,0.2);
        margin-top: 30px;
        margin-bottom: 30px;
    }
    
    .form-group {
        margin-bottom: 15px;
    }
    
    table {
        margin-top: 20px;
        background-color: white;
        border-radius: 5px;
        overflow: hidden;
        box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }
    
    .table-striped > tbody > tr:nth-child(odd) > td {
        background-color: #f8f9fa;
    }
    
    .footer-section {
        margin-top: 30px;
        padding-top: 20px;
        border-top: 1px solid #ddd;
    }
    
    h1.text-center {
        color: #333;
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 2px solid #007bff;
    }
    
    h2 {
        color: #333;
        margin-bottom: 20px;
    }
    
    .btn-primary {
        background-color: #007bff;
        border-color: #007bff;
        padding: 8px 20px;
        font-weight: bold;
        transition: all 0.3s ease;
    }
    
    .btn-primary:hover {
        background-color: #0056b3;
        border-color: #0056b3;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .form-control {
        border: 1px solid #ced4da;
        border-radius: 4px;
        padding: 8px 12px;
        transition: border 0.3s ease;
    }
    
    .form-control:focus {
        border-color: #007bff;
        box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
    }
    
    .well {
        background-color: #f8f9fa;
        border-left: 4px solid #007bff;
        border-radius: 4px;
        padding: 15px;
        margin-top: 10px;
    }
</style>
</head>
<body>
	<div class="container">
		<h1 class="text-center">SpringBootApp + MongoDB with Jenkins, Docker and K8S</h1>
		
		<div class="row">
			<div class="col-md-6">
				<form name="saveUser" action="/save" method="post" class="form-horizontal">
					<div class="form-group">
						<div class="blue-badge">First Name</div>
						<input type="text" id="firstName" class="form-control" 
						       placeholder="Enter first name" name="firstName" required />
					</div>

					<div class="form-group">
						<div class="blue-badge">Last Name</div>
						<input type="text" id="lastName" class="form-control" 
						       placeholder="Enter last name" name="lastName" required>
					</div>
					
					<div class="form-group">
						<div class="blue-badge">Age</div>
						<input type="number" id="age" class="form-control" 
						       placeholder="Enter age" name="age" min="1" max="100" required>
					</div>

					<div class="form-group">
						<div class="blue-badge">Email</div>
						<input type="email" id="email" class="form-control" 
						       placeholder="Enter email" name="email" required>
					</div>
					
					<div class="form-group">
						<button type="submit" class="btn btn-primary">
							<i class="glyphicon glyphicon-user"></i> Register Student
						</button>
						<button type="reset" class="btn btn-default">
							<i class="glyphicon glyphicon-refresh"></i> Clear Form
						</button>
					</div>
				</form>
			</div>
			
			<div class="col-md-6">
				<h3>Registration Info</h3>
				<div class="well">
					<p><strong>Instructions:</strong></p>
					<ol>
						<li>Fill in all fields marked with blue badges</li>
						<li>Click "Register Student" to save</li>
						<li>The student will appear in the table below</li>
						<li>Use "Clear Form" to reset all fields</li>
					</ol>
				</div>
				
				<div class="well">
					<p><strong>System Status:</strong></p>
					<p><span class="text-success"><i class="glyphicon glyphicon-ok"></i> MongoDB Connected</span></p>
					<p><span class="text-success"><i class="glyphicon glyphicon-ok"></i> Spring Boot Running</span></p>
					<p id="studentCount"><i class="glyphicon glyphicon-user"></i> Total Students: <span id="totalStudents">0</span></p>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-12">
				<h2>Registered Students</h2>
				<table id="usersTable" class="table table-striped table-bordered table-hover">
					<thead>
						<tr class="info">
							<th>ID</th>
							<th>First Name</th>
							<th>Last Name</th>
							<th>Age</th>
							<th>Email</th>
						</tr>
					</thead>
					<tbody>
						<!-- Data will be populated by JavaScript -->
						<tr id="noDataRow">
							<td colspan="5" class="text-center" style="padding: 30px;">
								<i class="glyphicon glyphicon-user" style="font-size: 30px; color: #ccc;"></i>
								<p style="margin-top: 10px; color: #666;">No students registered yet</p>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>

		<div class="row footer-section">
			<div class="col-md-3 text-center">
				<img th:src="@{/img/logo1.png}" alt="logo1.png" height="150" 
				     style="border-radius: 8px; border: 2px solid #007bff; padding: 5px; background: white;">
			</div>
			<div class="col-md-9">
				<h4 class="text-center">Landmark Technology - Software Development & DevOps Automation</h4>
				<h5 class="text-center">
					<i class="glyphicon glyphicon-phone"></i> Tel: +1 437-215-2483 | 
					<i class="glyphicon glyphicon-envelope"></i> Email: mylandmarktech@gmail.com
				</h5>
				<h5 class="text-center">
					<i class="glyphicon glyphicon-copyright-mark"></i> Copyright 2024 by 
					<a href="http://www.mylandmarktech.com/">Landmark Technology</a>
				</h5>
			</div>
		</div>
	</div>

	<script>
		$(document).ready(function() {
			// Load existing users
			loadUsers();
			
			// Handle form submission
			$('form[name="saveUser"]').submit(function(e) {
				e.preventDefault();
				
				var formData = $(this).serialize();
				
				$.ajax({
					url: $(this).attr('action'),
					type: 'POST',
					data: formData,
					success: function(response) {
						// Clear form
						$('form[name="saveUser"]')[0].reset();
						
						// Reload users
						loadUsers();
						
						// Show success message
						showMessage('Student registered successfully!', 'success');
					},
					error: function() {
						showMessage('Error registering student. Please try again.', 'danger');
					}
				});
			});
			
			// Auto-refresh every 10 seconds
			setInterval(loadUsers, 10000);
		});
		
		function loadUsers() {
			$.ajax({
				url: "/api/users",
				success: function(response) {
					var tbody = $("#usersTable tbody");
					
					if (response.length === 0) {
						tbody.html('<tr id="noDataRow"><td colspan="5" class="text-center" style="padding: 30px;"><i class="glyphicon glyphicon-user" style="font-size: 30px; color: #ccc;"></i><p style="margin-top: 10px; color: #666;">No students registered yet</p></td></tr>');
						$('#totalStudents').text('0');
						return;
					}
					
					// Remove "no data" row
					$('#noDataRow').remove();
					
					// Clear and rebuild table
					tbody.empty();
					
					$.each(response, function(i, item) {
						var row = $("<tr></tr>");
						
						row.append($("<td>" + (item.id || 'N/A') + "</td>"));
						row.append($("<td>" + (item.firstName || '') + "</td>"));
						row.append($("<td>" + (item.lastName || '') + "</td>"));
						row.append($("<td><span class='badge' style='background-color: #007bff;'>" + (item.age || 'N/A') + "</span></td>"));
						row.append($("<td>" + (item.email || '') + "</td>"));
						
						tbody.append(row);
					});
					
					// Update student count
					$('#totalStudents').text(response.length);
				},
				error: function() {
					$("#usersTable tbody").html('<tr><td colspan="5" class="text-center text-danger"><i class="glyphicon glyphicon-warning-sign"></i> Error loading data</td></tr>');
				}
			});
		}
		
		function showMessage(message, type) {
			// Remove any existing alerts
			$('.alert-message').remove();
			
			// Create alert div
			var alertClass = type === 'success' ? 'alert-success' : 'alert-danger';
			var iconClass = type === 'success' ? 'glyphicon-ok-sign' : 'glyphicon-warning-sign';
			
			var alertDiv = $('<div class="alert ' + alertClass + ' alert-dismissible alert-message" style="position: fixed; top: 20px; right: 20px; z-index: 1000; max-width: 300px;">' +
							'<button type="button" class="close" data-dismiss="alert">&times;</button>' +
							'<strong><i class="glyphicon ' + iconClass + '"></i> ' + 
							(type === 'success' ? 'Success!' : 'Error!') + '</strong> ' + message +
							'</div>');
			
			$('body').append(alertDiv);
			
			// Auto-remove after 5 seconds
			setTimeout(function() {
				alertDiv.alert('close');
			}, 5000);
		}
	</script>
</body>
</html>