<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" type="text/css"
	th:href="@{/webjars/bootstrap/3.3.7/css/bootstrap.min.css}" />

<!-- include java script in the footer -->
<script type="text/javascript"
	th:src="@{/webjars/jquery/3.2.1/jquery.min.js/}"></script>
<script type="text/javascript"
	th:src="@{/webjars/bootstrap/3.3.7/js/bootstrap.min.js}"></script>

<title>Spring Boot APP with MongoDB</title>

<style>
    body {
        background-color: #ffffff;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        padding-bottom: 30px;
    }
    
    .blue-badge {
        background-color: #1a73e8;
        color: white;
        padding: 6px 12px;
        border-radius: 6px;
        display: inline-block;
        margin-bottom: 8px;
        font-size: 13px;
        font-weight: bold;
        box-shadow: 0 2px 4px rgba(26, 115, 232, 0.3);
    }
    
    .container {
        background-color: #ffffff;
        padding: 20px;
        border-radius: 8px;
        margin-top: 20px;
        border: 1px solid #e0e0e0;
    }
    
    .form-group {
        margin-bottom: 20px;
    }
    
    .form-section {
        background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(21, 101, 192, 0.1);
        border: 1px solid #bbdefb;
    }
    
    table {
        margin-top: 20px;
        background-color: white;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    }
    
    .table-striped > tbody > tr:nth-child(odd) > td {
        background-color: #f8f9fa;
    }
    
    .table-striped > tbody > tr:hover > td {
        background-color: #e3f2fd;
    }
    
    .footer-section {
        margin-top: 30px;
        padding-top: 20px;
        border-top: 1px solid #e0e0e0;
    }
    
    h1.text-center {
        color: #1a73e8;
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 3px solid #1a73e8;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }
    
    h2 {
        color: #1a73e8;
        margin-bottom: 20px;
        padding-left: 10px;
        border-left: 4px solid #1a73e8;
    }
    
    h3 {
        color: #1a73e8;
        margin-bottom: 15px;
    }
    
    .btn-primary {
        background: linear-gradient(to right, #1a73e8, #4285f4);
        border-color: #1a73e8;
        padding: 10px 25px;
        font-weight: bold;
        border-radius: 6px;
        transition: all 0.3s ease;
        box-shadow: 0 3px 8px rgba(26, 115, 232, 0.3);
    }
    
    .btn-primary:hover {
        background: linear-gradient(to right, #0d62d9, #1a73e8);
        border-color: #0d62d9;
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(26, 115, 232, 0.4);
    }
    
    .btn-default {
        background-color: #f1f3f4;
        border-color: #dadce0;
        padding: 10px 25px;
        font-weight: bold;
        border-radius: 6px;
        transition: all 0.3s ease;
    }
    
    .btn-default:hover {
        background-color: #e8eaed;
        transform: translateY(-2px);
    }
    
    .form-control {
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        padding: 10px 15px;
        transition: all 0.3s ease;
        font-size: 14px;
    }
    
    .form-control:focus {
        border-color: #1a73e8;
        box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.2);
    }
    
    .well {
        background-color: #f8f9fa;
        border-left: 4px solid #1a73e8;
        border-radius: 8px;
        padding: 15px;
        margin-top: 10px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    
    .info-panel {
        background: linear-gradient(135deg, #f8f9fa 0%, #e8eaed 100%);
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        border: 1px solid #e8eaed;
    }
    
    .table > thead > tr > th {
        background: linear-gradient(to right, #1a73e8, #4285f4);
        color: white;
        font-weight: bold;
        border: none;
    }
    
    .badge-blue {
        background-color: #1a73e8;
        color: white;
        padding: 4px 10px;
        border-radius: 12px;
        font-weight: bold;
    }
    
    .contact-info {
        background-color: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #e8eaed;
    }
    
    .logo-container {
        background: linear-gradient(135deg, #f8f9fa 0%, #e8eaed 100%);
        padding: 15px;
        border-radius: 10px;
        border: 2px solid #1a73e8;
        display: inline-block;
    }
</style>
</head>
<body>
	<div class="container">
		<h1 class="text-center">Student Registration</h1>
		
		<div class="row">
			<div class="col-md-6">
				<div class="form-section">
					<form name="saveUser" action="/save" method="post" class="form-horizontal">
						<div class="form-group">
							<div class="blue-badge">First Name</div>
							<input type="text" id="firstName" class="form-control" 
							       placeholder="Enter first name" name="firstName" required />
						</div>

						<div class="form-group">
							<div class="blue-badge">Last Name</div>
							<input type="text" id="lastName" class="form-control" 
							       placeholder="Enter last name" name="lastName" required>
						</div>
						
						<div class="form-group">
							<div class="blue-badge">Age</div>
							<input type="number" id="age" class="form-control" 
							       placeholder="Enter age" name="age" min="1" max="100" required>
						</div>

						<div class="form-group">
							<div class="blue-badge">Email</div>
							<input type="email" id="email" class="form-control" 
							       placeholder="student@example.com" name="email" required>
						</div>
						
						<div class="form-group text-center">
							<button type="submit" class="btn btn-primary">
								<i class="glyphicon glyphicon-user"></i> Register Student
							</button>
							<button type="reset" class="btn btn-default">
								<i class="glyphicon glyphicon-refresh"></i> Clear Form
							</button>
						</div>
					</form>
				</div>
			</div>
			
			<div class="col-md-6">
				<div class="info-panel">
					<h3><i class="glyphicon glyphicon-info-sign"></i> Registration Info</h3>
					<div class="well">
						<p><strong>Instructions:</strong></p>
						<ol>
							<li>Fill in all fields marked with blue badges</li>
							<li>Click "Register Student" to save</li>
							<li>The student will appear in the table below</li>
							<li>Use "Clear Form" to reset all fields</li>
						</ol>
					</div>
					
					<div class="well">
						<p><strong>System Status:</strong></p>
						<p><span class="text-success"><i class="glyphicon glyphicon-ok"></i> MongoDB Connected</span></p>
						<p><span class="text-success"><i class="glyphicon glyphicon-ok"></i> Spring Boot Running</span></p>
						<p id="studentCount"><i class="glyphicon glyphicon-user"></i> Total Students: <span id="totalStudents" class="badge-blue">0</span></p>
					</div>
				</div>
			</div>
		</div>

		<div class="row">
			<div class="col-md-12">
				<h2><i class="glyphicon glyphicon-list"></i> Registered Students</h2>
				<table id="usersTable" class="table table-striped table-bordered table-hover">
					<thead>
						<tr>
							<th>ID</th>
							<th>First Name</th>
							<th>Last Name</th>
							<th>Age</th>
							<th>Email</th>
						</tr>
					</thead>
					<tbody>
						<!-- Data will be populated by JavaScript -->
						<tr id="noDataRow">
							<td colspan="5" class="text-center" style="padding: 40px;">
								<i class="glyphicon glyphicon-user" style="font-size: 40px; color: #bbdefb;"></i>
								<p style="margin-top: 15px; color: #757575; font-size: 16px;">No students registered yet</p>
								<p style="color: #9e9e9e;">Register your first student using the form above</p>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>

		<div class="row footer-section">
			<div class="col-md-3 text-center">
				<div class="logo-container">
					<img th:src="@{/img/logo1.png}" alt="logo1.png" height="130" 
					     style="border-radius: 6px;">
				</div>
			</div>
			<div class="col-md-9">
				<div class="contact-info">
					<h4 class="text-center" style="color: #1a73e8;">Landmark Technology - Software Development & DevOps Automation</h4>
					<h5 class="text-center">
						<i class="glyphicon glyphicon-phone"></i> Tel: +1 437-215-2483 | 
						<i class="glyphicon glyphicon-envelope"></i> Email: mylandmarktech@gmail.com
					</h5>
					<h5 class="text-center">
						<i class="glyphicon glyphicon-copyright-mark"></i> Copyright 2024 by 
						<a href="http://www.mylandmarktech.com/" style="color: #1a73e8; font-weight: bold;">Landmark Technology</a>
					</h5>
				</div>
			</div>
		</div>
	</div>

	<script>
		$(document).ready(function() {
			// Load existing users
			loadUsers();
			
			// Handle form submission
			$('form[name="saveUser"]').submit(function(e) {
				e.preventDefault();
				
				var formData = $(this).serialize();
				
				$.ajax({
					url: $(this).attr('action'),
					type: 'POST',
					data: formData,
					success: function(response) {
						// Clear form
						$('form[name="saveUser"]')[0].reset();
						
						// Reload users
						loadUsers();
						
						// Show success message
						showMessage('Student registered successfully!', 'success');
					},
					error: function() {
						showMessage('Error registering student. Please try again.', 'danger');
					}
				});
			});
			
			// Auto-refresh every 10 seconds
			setInterval(loadUsers, 10000);
		});
		
		function loadUsers() {
			$.ajax({
				url: "/api/users",
				success: function(response) {
					var tbody = $("#usersTable tbody");
					
					if (response.length === 0) {
						tbody.html('<tr id="noDataRow"><td colspan="5" class="text-center" style="padding: 40px;"><i class="glyphicon glyphicon-user" style="font-size: 40px; color: #bbdefb;"></i><p style="margin-top: 15px; color: #757575; font-size: 16px;">No students registered yet</p><p style="color: #9e9e9e;">Register your first student using the form above</p></td></tr>');
						$('#totalStudents').text('0');
						return;
					}
					
					// Remove "no data" row
					$('#noDataRow').remove();
					
					// Clear and rebuild table
					tbody.empty();
					
					$.each(response, function(i, item) {
						var row = $("<tr></tr>");
						
						row.append($("<td><span style='color: #666;'>" + (item.id ? item.id.substring(0, 8) + '...' : 'N/A') + "</span></td>"));
						row.append($("<td><strong>" + (item.firstName || '') + "</strong></td>"));
						row.append($("<td><strong>" + (item.lastName || '') + "</strong></td>"));
						row.append($("<td><span class='badge-blue'>" + (item.age || 'N/A') + "</span></td>"));
						row.append($("<td><span style='color: #1a73e8;'><i class='glyphicon glyphicon-envelope'></i> " + (item.email || '') + "</span></td>"));
						
						tbody.append(row);
					});
					
					// Update student count
					$('#totalStudents').text(response.length);
				},
				error: function() {
					$("#usersTable tbody").html('<tr><td colspan="5" class="text-center text-danger"><i class="glyphicon glyphicon-warning-sign"></i> Error loading data</td></tr>');
				}
			});
		}
		
		function showMessage(message, type) {
			// Remove any existing alerts
			$('.alert-message').remove();
			
			// Create alert div
			var alertClass = type === 'success' ? 'alert-success' : 'alert-danger';
			var iconClass = type === 'success' ? 'glyphicon-ok-sign' : 'glyphicon-warning-sign';
			var bgColor = type === 'success' ? '#1a73e8' : '#d32f2f';
			
			var alertDiv = $('<div class="alert ' + alertClass + ' alert-dismissible alert-message" style="position: fixed; top: 20px; right: 20px; z-index: 1000; max-width: 300px; border-radius: 8px; border-left: 5px solid ' + bgColor + '; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">' +
							'<button type="button" class="close" data-dismiss="alert">&times;</button>' +
							'<strong><i class="glyphicon ' + iconClass + '"></i> ' + 
							(type === 'success' ? 'Success!' : 'Error!') + '</strong><br>' + message +
							'</div>');
			
			$('body').append(alertDiv);
			
			// Auto-remove after 5 seconds
			setTimeout(function() {
				alertDiv.alert('close');
			}, 5000);
		}
	</script>
</body>
</html>